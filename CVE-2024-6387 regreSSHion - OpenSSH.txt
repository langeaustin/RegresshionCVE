CVE-2024-6387 regreSSHion - OpenSSH RCE Vulnerability Detected 

Vulnerability Report: Regression Vulnerability and Remote Code Execution (RCE) Susceptibility

Summary: The following devices in our network have been identified as susceptible to a regreSSHion vulnerability leading to potential Remote Code Execution (RCE). This vulnerability poses a significant risk to the security and integrity of our systems and requires attention and review.

 

 

https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt

On July 1st a 0 day was discovered by Qualy’s researchers affecting all devices running OpenSSH Version’s 0-4.4 and 8.5/8.5p1-9.8/9.8p1

Upon a scan of our network I’ve identified the following devices as vulnerable to this exploit: 
| DEVICE                         | IP Address      | Latency   | SSH Version     |
---------------------------------------------------------------------------------
| [REDACTED]                     | [REDACTED]      | 0.19s     | OpenSSH 8.9p1   |
---------------------------------------------------------------------------------
| [REDACTED]                     | -               | 0.0014s   | OpenSSH 8.7     |
---------------------------------------------------------------------------------
| [REDACTED]                     | [REDACTED]      | 0.0021s   | OpenSSH 8.9p1   |
---------------------------------------------------------------------------------
| [REDACTED]                     | [REDACTED]      | 0.0014s   | OpenSSH 8.7     |
---------------------------------------------------------------------------------
| [REDACTED]                     | -               | 0.00096s  | OpenSSH 8.9p1   |
---------------------------------------------------------------------------------
| [REDACTED]                     | [REDACTED]      | 0.00091s  | OpenSSH 8.9p1   |
---------------------------------------------------------------------------------

 

Mitigation: 

    Download the latest patched version: Visit the official OpenSSH website here to download the latest patched version compatible with your operating system. Or run this command: 

sudo apt update && sudo apt install openssh-server

Remove any unpatched devices that are facing the internet. 

If neither of the above are an option: the problematic code is only reached when the LoginGraceTime signal-based timer fires, this vulnerability can be eliminated by setting this configuration option to 0 (indefinite). If you wish to continue with this mitigation, you can issue the following commands:
echo "LoginGraceTime 0" | sudo tee /etc/ssh/sshd_config.d/cve-2024-6387.conf
sudo systemctl reload ssh.service